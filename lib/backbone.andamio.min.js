/*! backbone.andamio v1.2.5 | http://andamiojs.com | https://github.com/dciccale/Andamio.js/blob/master/LICENSE.txt */
(function(e,t,i){"use strict";var n={$:i.$,extend:i.Model.extend};e.Andamio=i.Andamio=n,function(e){function i(e,t,i,n,s){if(!n)throw Error('Method "'+s+'" was configured as an event handler, but does not exist.');e.listenTo(t,i,n)}function n(e,t,i,n){e.stopListening(t,i,n)}function s(e,i,n,s,o){t.each(s,function(t){var s=e[t];o(e,i,n,s,t)})}function o(e,i,n,o){i&&n&&t.each(n,function(t,n){var h=t.split(r);s(e,i,n,h,o)})}var r=/\s+/;e.bindEvents=function(e,t,n){o(e,t,n,i)},e.unbindEvents=function(e,t,i){o(e,t,i,n)}}(n),n.Region=function(e){if(t.extend(this,e),!this.el&&!this.$el)throw Error('An "el" or "$el" property must be specified for a region');this.initialize&&this.initialize.apply(this,arguments)},t.extend(n.Region.prototype,i.Events,{show:function(e){var i;this._ensureEl(),i=e!==this.currentView,i&&this.close(),e.render(),(i||e.isClosed)&&this.open(e),this.currentView=e,this.trigger.call(this,"show",e),t.isFunction(this.onShow)&&this.onShow.apply(this,t.tail(arguments))},open:function(e){this.$el.empty().append(e.el)},close:function(){var e=this.currentView;e&&!e.isClosed&&(e.close?e.close():e.remove&&e.remove(),t.isFunction(this.onClose)&&this.onClose(),delete this.currentView)},_ensureEl:function(){this.$el&&0!==this.$el.length||(this.$el=$('[data-region="'+this.el+'"]'))},reset:function(){this.close(),delete this.$el}}),n.View=function(){t.bindAll(this,"render"),this.model&&(this.model=new this.model),this.collection&&(this.collection=new this.collection),i.View.prototype.constructor.apply(this,arguments)},t.extend(n.View.prototype,i.View.prototype,{render:function(){var e,i;return this.isClosed=!1,e=this._serializeData(),i=n.Utils.render(this.template,e),this.$el.html(i),this._createSubViews(),this._bindRegions(),this._bindUIElements(),t.isFunction(this.afterRender)&&this.afterRender(),this},_serializeData:function(){return this.model?this.model.toJSON():this.collection?{items:this.collection.toJSON()}:{}},_bindRegions:function(){var e=this.$("[data-region]");e.length&&(this.regions={},t.each(e,function(e){var t=$(e),i=t.attr("data-region");this.regions[i]=new n.Region({$el:t})},this))},_unbindRegions:function(){this.regions&&this._deleteProp("regions")},_createSubViews:function(){this.subviews&&(this._subviews||(this._subviews=this.subviews),this.subviews={},t.each(t.keys(this._subviews),function(e){this.subviews[e]=new this._subviews[e]},this))},_removeSubviews:function(){this.subviews&&(t.invoke(this.subviews,"close"),this._deleteProp("subviews"),this.subviews=this._subviews,delete this._subviews)},_bindUIElements:function(){this.ui&&(this._ui||(this._ui=this.ui),this.ui={},t.each(t.keys(this._ui),function(e){this.ui[e]=this.$(this._ui[e])},this))},_unbindUIElements:function(){this.ui&&(this._deleteProp("ui"),this.ui=this._ui,delete this._ui)},close:function(){this.isClosed||(this.isClosed=!0,this._removeSubviews(),this._unbindRegions(),this._unbindUIElements(),this.remove())},delegateEvents:function(e){i.View.prototype.delegateEvents.call(this,e),n.bindEvents(this,this.model,this.modelEvents),n.bindEvents(this,this.collection,this.collectionEvents)},undelegateEvents:function(){i.View.prototype.undelegateEvents.apply(this,arguments),n.unbindEvents(this,this.model,this.modelEvents),n.unbindEvents(this,this.collection,this.collectionEvents)},_deleteProp:function(e){var i=this[e];t.each(i,function(e,t){delete i[t]},this),delete this[e]}}),n.View.extend=i.View.extend,n.Model=i.Model.extend({constructor:function(e,t){this.configure(t),i.Model.apply(this,arguments),this._mixinComputedProperties()},configure:function(e){t.extend(this.defaults,this.constructor.__super__.defaults),this.options=e||{}},defaults:{ready:!1},isReady:function(){return!0},setReady:function(){this.set("ready",!0)},_mixinComputedProperties:function(){var e=this.attributes||{};return t.extend(e,this.computedProperties)},load:function(){}}),n.Router=i.Router.extend({_bindRoutes:function(){this.routes&&t.each(this.routes,function(e){var t=this._createCallback(e.url,e.name,e.view);this.route(e.url,e.name,t)},this)},_createCallback:function(e,i,n){var s=this,o=function(){var i=arguments,o=new n;o.model&&t.isFunction(o.model.load)&&o.model.load.apply(o.model,i),s.trigger("navigate",o,e,i)};return o}}),n.Application=function(e){t.extend(this,e),this.vent=t.extend({},i.Events)},t.extend(n.Application.prototype,i.Events,{container:"main",el:"page",start:function(e){e.appView&&this._initAppView(e.appView),this.router&&this._initRouter(),this.initialize.apply(this,arguments)},initialize:function(){},_initRouter:function(){var e=this;if(this.router=new this.router,this.appRegion=new n.Region({el:this.el,initialize:function(){this.listenTo(e.router,"navigate",this.show)},onShow:function(){e.vent.trigger("navigate",this.currentView)}}),i.history.start(),!i.history.fragment){var s=t.findWhere(this.router.routes,{"default":!0});s&&this.router.navigate(s.url,{trigger:!0})}},_initAppView:function(e){$(this.container).empty().append(e.render().el),this.appView=e}}),n.Application.extend=n.extend,n.Utils={render:function(e,t){if(!e)throw Error("Cannot render the template since it's false, null or undefined.");return e(t)}},function(e,t){if("object"==typeof exports){var i=require("underscore"),n=require("backbone");module.exports=t(i,n)}else"function"==typeof define&&define.amd&&define(["underscore","backbone"],t)}(this,function(){return n})})(this,_,Backbone);
//@ sourceMappingURL=lib/backbone.andamio.sourcemap.js