/*! backbone.andamio v1.2.0 | http://andamiojs.com | https://github.com/dciccale/Andamio.js/blob/master/LICENSE.txt */
(function(t,i,e){"use strict";var n={$:i.$,extend:i.Model.extend};(function(t){function i(t,i,n,s){var o=s.split(/\s+/);e.each(o,function(e){var s=t[e];if(!s)throw Error('Method "'+e+'" was configured as an event handler, but does not exist.');t.listenTo(i,n,s,t)})}function n(t,i,n,s){var o=s.split(/\s+/);e.each(o,function(){var e=t[e];t.stopListening(i,n,e,t)})}function s(t,i,n,s){i&&n&&(e.isFunction(n)&&(n=n.call(t)),e.each(n,function(e,n){s(t,i,n,e)}))}t.bindEvents=function(t,e,n){s(t,e,n,i)},t.unbindEvents=function(t,i,e){s(t,i,e,n)}})(n),n.Region=function(t){this.options=t||{},this.$el=this.options.$el},e.extend(n.Region,{show:function(t){this._ensureEl(),t!==this.currentView?(this.close(),t.render(),this.open(t)):t.render(),this.currentView=t,e.isFunction(this.onShow)&&this.onShow()},open:function(t){this.$el.empty().append(t.el)},close:function(){var t=this.currentView;t&&!t.isClosed&&(t.close(),delete this.currentView)},_ensureEl:function(){this.$el&&0!==this.$el.length||(this.$el=$('[data-region="'+this.el+'"]'))}}),n.View=i.View.extend({constructor:function(){e.bindAll(this),i.View.apply(this,arguments),this._bindSubviews()},render:function(){this.isClosed=!1;var t=this._serializeData(t);return this.$el.html(this.template(t)),this._bindRegions(),this._bindUIElements(),e.isFunction(this.afterRender)&&this.afterRender(),this},_serializeData:function(t){return this.model?this.model.toJSON():this.collection?{items:this.collection.toJSON()}:t},_bindRegions:function(){var t=this,i=t.$("[data-region]");i.length&&(t.regions={},i.each(function(i,e){var s=$(e),o=s.attr("data-region"),r=t.subviews[o];t.regions[o]=new n.Region({$el:s}),r&&(t.subviews[o]=new r({el:s}))}))},_unbindRegions:function(){this.regions&&(this._deleteProp("regions"),this.regions={})},_bindUIElements:function(){this._bindProp("ui",function(t,i,e){this[i][e]=this.$(t[e])})},_unbindUIElements:function(){this._unbindProp("ui")},_bindSubviews:function(){this._bindProp("subviews",function(t,i,e){this[i][e]=t[e]})},_unbindSubviews:function(){this._unbindProp("subviews")},_unbindProp:function(t){var i="_"+t;this[t]&&(this._deleteProp(t),this[t]=this[i],delete this[i])},_bindProp:function(t,i){var n="_"+t;if(this[t]){this[n]||(this[n]=this[t]);var s=e.result(this,n);this[t]={},e.each(e.keys(s),function(e){i.call(this,s,t,e)},this)}},_removeSubviews:function(){e.each(this.subviews,function(t){t.close()})},_deleteProp:function(t,i){var n=this[t];e.each(n,function(t,e){i&&i.call(this,t,e),delete n[e]},this),delete this[t]},close:function(){this.isClosed||(this.isClosed=!0,this._removeSubviews(),this._unbindSubviews(),this._unbindRegions(),this._unbindUIElements(),this.remove())},delegateEvents:function(t){n.bindEvents(this,this.model,this.modelEvents),n.bindEvents(this,this.collection,this.collectionEvents),i.View.prototype.delegateEvents.call(this,t)},undelegateEvents:function(){i.View.prototype.undelegateEvents.apply(this,arguments),n.unbindEvents(this,this.model,this.modelEvents),n.unbindEvents(this,this.collection,this.collectionEvents)}}),n.Model=i.Model.extend({constructor:function(t,e){this.configure(e),i.Model.apply(this,arguments),this._mixinComputedProperties()},configure:function(t){e.extend(this.defaults,this.constructor.__super__.defaults),this.options=t||{},e.bindAll(this)},defaults:{ready:!1},isReady:function(){return!0},_setReady:function(){this.set("ready",!0)},_mixinComputedProperties:function(){var t=this.attributes||{};return e.extend(t,this.computedProperties)},load:function(){}}),n.Router=i.Router.extend({constructor:function(t){if(e.extend(this,t),!this.viewsPath)throw Error('Provide a correct path for the views in the "viewsPath" option.');this._initRoutes(),this.initialize.apply(this,arguments)},initialize:function(){},viewsPath:"views/",_initRoutes:function(){e.each(this.routes,function(t){var i=t.url,e=t.view,n=this._routeCallback(i,e);this.route(i,e,n)},this)},_routeCallback:function(t,i){var n=this,s=function(){var s=arguments;require([n.viewsPath+i],function(i){var o=new i;o.model&&e.isFunction(o.model.load)&&o.model.load.apply(o.model,s),n.trigger("navigate",o,t,s)})};return s}}),n.Application=function(t){e.extend(this,t),this.vent=e.extend({},i.Events)},e.extend(n.Application.prototype,i.Events,n.Region,{container:"body",el:"main",start:function(){this._initRouter(),this._initAppView(),this.initialize.apply(this,arguments),this.listenTo(this.router,"navigate",this.show)},initialize:function(){},_initRouter:function(){this.router=new this.router},_initAppView:function(){this.appView=new this.appView({el:this.container}),this.appView.render()},onShow:function(){this.appView.trigger("navigate",this.currentView)}}),n.Application.extend=n.extend,t.Andamio=i.Andamio=n,function(t,i){if("object"==typeof exports){var e=require("underscore"),n=require("backbone");module.exports=i(e,n)}else"function"==typeof define&&define.amd&&define(["underscore","backbone"],i)}(this,function(){return n})})(this,Backbone,_);
//@ sourceMappingURL=lib/backbone.andamio.sourcemap.js