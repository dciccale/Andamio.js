/*! backbone.andamio v1.2.4 | http://andamiojs.com | https://github.com/dciccale/Andamio.js/blob/master/LICENSE.txt */
(function(t,e,i){"use strict";var n={$:e.$,extend:e.Model.extend};(function(t){function e(t,e,i,n,s){if(!n)throw Error('Method "'+s+'" was configured as an event handler, but does not exist.');t.listenTo(e,i,n)}function n(t,e,i,n){t.stopListening(e,i,n)}function s(t,e,n,s,o){i.each(s,function(i){var s=t[i];o(t,e,n,s,i)})}function o(t,e,n,o){e&&n&&i.each(n,function(i,n){var h=i.split(r);s(t,e,n,h,o)})}var r=/\s+/;t.bindEvents=function(t,i,n){o(t,i,n,e)},t.unbindEvents=function(t,e,i){o(t,e,i,n)}})(n),n.Region=function(t){this.options=t||{},this.$el=this.options.$el},i.extend(n.Region,{show:function(t){this._ensureEl(),t!==this.currentView?(this.close(),t.render(),this.open(t)):t.render(),this.currentView=t,i.isFunction(this.onShow)&&this.onShow()},open:function(t){this.$el.empty().append(t.el)},close:function(){var t=this.currentView;t&&!t.isClosed&&(t.close(),delete this.currentView)},_ensureEl:function(){this.$el&&0!==this.$el.length||(this.$el=$('[data-region="'+this.el+'"]'))}}),n.View=e.View.extend({constructor:function(){i.bindAll(this),this.model&&(this.model=new this.model),this.collection&&(this.collection=new this.collection),e.View.apply(this,arguments)},render:function(){this.isClosed=!1;var t=this._serializeData();return this.$el.html(this.template(t)),this._bindRegions(),this._bindUIElements(),i.isFunction(this.afterRender)&&this.afterRender(),this},_serializeData:function(){return this.model?this.model.toJSON():this.collection?{items:this.collection.toJSON()}:{}},_bindRegions:function(){var t=this,e=t.$("[data-region]");e.length&&(t.regions={},e.each(function(e,s){var o=$(s),r=o.attr("data-region"),h=t.subviews[r];t.regions[r]=new n.Region({$el:o}),h&&i.isFunction(h)?t.subviews[r]=new h({el:o}):h&&h.setElement(o).render()}))},_unbindRegions:function(){this.regions&&this._deleteProp("regions")},_bindUIElements:function(){this.ui&&(this._ui||(this._ui=this.ui),this.ui={},i.each(i.keys(this._ui),function(t){this.ui[t]=this.$(this._ui[t])},this))},_unbindUIElements:function(){this.ui&&(this._deleteProp("ui"),this.ui=this._ui,delete this._ui)},_removeSubviews:function(){this.subviews&&(i.invoke(this.subviews,"close"),this._deleteProp("subviews"))},close:function(){this.isClosed||(this.isClosed=!0,this._removeSubviews(),this._unbindRegions(),this._unbindUIElements(),this.remove())},delegateEvents:function(t){e.View.prototype.delegateEvents.call(this,t),n.bindEvents(this,this.model,this.modelEvents),n.bindEvents(this,this.collection,this.collectionEvents)},undelegateEvents:function(){e.View.prototype.undelegateEvents.apply(this,arguments),n.unbindEvents(this,this.model,this.modelEvents),n.unbindEvents(this,this.collection,this.collectionEvents)},_deleteProp:function(t){var e=this[t];i.each(e,function(t,i){delete e[i]},this),delete this[t]}}),n.Model=e.Model.extend({constructor:function(t,i){this.configure(i),e.Model.apply(this,arguments),this._mixinComputedProperties()},configure:function(t){i.extend(this.defaults,this.constructor.__super__.defaults),this.options=t||{},i.bindAll(this)},defaults:{ready:!1},isReady:function(){return!0},_setReady:function(){this.set("ready",!0)},_mixinComputedProperties:function(){var t=this.attributes||{};return i.extend(t,this.computedProperties)},load:function(){}}),n.Router=e.Router.extend({constructor:function(t){if(i.extend(this,t),!this.viewsPath)throw Error('Provide a correct path for the views in the "viewsPath" option.');this._initRoutes(),this.initialize.apply(this,arguments)},initialize:function(){},viewsPath:"views/",_initRoutes:function(){i.each(this.routes,function(t){var e=t.url,i=t.view,n=this._routeCallback(e,i);this.route(e,i,n)},this)},_routeCallback:function(t,e){var n=this,s=function(){var s=arguments;require([n.viewsPath+e],function(e){var o=new e;o.model&&i.isFunction(o.model.load)&&o.model.load.apply(o.model,s),n.trigger("navigate",o,t,s)})};return s}}),n.Application=function(t){i.extend(this,t),this.vent=i.extend({},e.Events)},i.extend(n.Application.prototype,e.Events,n.Region,{container:"main",el:"page",start:function(t){i.extend(this,t),this._initRouter(),this.initialize.apply(this,arguments),this._initAppView(),this.listenTo(this.router,"navigate",this.show)},initialize:function(){},_initRouter:function(){this.router=new this.router,e.history.start();var t=i.findWhere(this.router.routes,{"default":!0});t&&!e.history.fragment&&this.router.navigate(t.url,{trigger:!0,replace:!0})},_initAppView:function(){this.appView=new this.appView({el:this.container}),this.appView.render()},onShow:function(){this.vent.trigger("navigate",this.currentView)}}),n.Application.extend=n.extend,t.Andamio=e.Andamio=n,function(t,e){if("object"==typeof exports){var i=require("underscore"),n=require("backbone");module.exports=e(i,n)}else"function"==typeof define&&define.amd&&define(["underscore","backbone"],e)}(this,function(){return n})})(this,Backbone,_);
//@ sourceMappingURL=lib/backbone.andamio.sourcemap.js