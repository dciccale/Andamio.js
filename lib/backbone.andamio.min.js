/*! backbone.andamio v1.2.8 | http://andamiojs.com | https://github.com/dciccale/Andamio.js/blob/master/LICENSE.txt */

!function(a,b,c){"use strict";var d={$:c.$,extend:c.Model.extend};a.Andamio=c.Andamio=d,d.Utils={render:function(a,b){if(!a)throw new Error("Cannot render the template since it's false, null or undefined.");return a(b)}},function(a){function c(a,b,c,d,e){if(!d)throw new Error('Method "'+e+'" was configured as an event handler, but does not exist.');a.listenTo(b,c,d)}function d(a,b,c,d){a.stopListening(b,c,d)}function e(a,c,d,e,f){b.each(e,function(b){var e=a[b];f(a,c,d,e,b)})}function f(a,c,d,f){c&&d&&b.each(d,function(b,d){var h=b.split(g);e(a,c,d,h,f)})}var g=/\s+/;a.bindEvents=function(a,b,d){f(a,b,d,c)},a.unbindEvents=function(a,b,c){f(a,b,c,d)}}(d),d.Region=function(a){if(b.extend(this,a),!this.el&&!this.$el)throw new Error('An "el" or "$el" property must be specified for a region');this.initialize&&this.initialize.apply(this,arguments)},b.extend(d.Region.prototype,c.Events,{show:function(a){var c;this._ensureEl(),c=a!==this.currentView,c&&this.close(),a.render(),(c||a.isClosed)&&this.open(a),this.currentView=a,this.trigger.call(this,"show",a),b.isFunction(this.onShow)&&this.onShow.apply(this,b.tail(arguments))},open:function(a){this.$el.empty().append(a.el)},close:function(){var a=this.currentView;a&&!a.isClosed&&(a.close?a.close():a.remove&&a.remove(),b.isFunction(this.onClose)&&this.onClose(),delete this.currentView)},_ensureEl:function(){this.$el&&0!==this.$el.length||(this.$el=$('[data-region="'+this.el+'"]'))},reset:function(){this.close(),delete this.$el}}),d.View=c.View.extend({constructor:function(){b.bindAll(this,"render"),c.View.prototype.constructor.apply(this,arguments)},_bindRegions:function(){var a=this.$("[data-region]");a.length&&(this.regions={},b.each(a,function(a){var b=$(a),c=b.attr("data-region");this.regions[c]=new d.Region({$el:b})},this))},_unbindRegions:function(){this.regions&&this._deleteProp("regions")},addSubview:function(a,c){this.subviews||(this.subviews={}),this.subviews[a]=b.isFunction(c)?new c:c},_createSubViews:function(){this.subviews&&(this._subviews||(this._subviews=this.subviews),this.subviews={},b.each(b.keys(this._subviews),function(a){this.addSubview(a,this._subviews[a])},this))},_removeSubviews:function(){this.subviews&&(b.invoke(this.subviews,"close"),this._deleteProp("subviews"),this.subviews=this._subviews,delete this._subviews)},_bindUIElements:function(){this.ui&&(this._ui||(this._ui=this.ui),this.ui=b.object(b.map(this._ui,function(a,b){return[b,this.$(a)]},this)))},_unbindUIElements:function(){this.ui&&(this._deleteProp("ui"),this.ui=this._ui,delete this._ui)},close:function(){this.isClosed||(this.isClosed=!0,this._removeSubviews(),this._unbindRegions(),this._unbindUIElements(),this.remove())},delegateEvents:function(a){c.View.prototype.delegateEvents.call(this,a),d.bindEvents(this,this.model,this.modelEvents),d.bindEvents(this,this.collection,this.collectionEvents)},undelegateEvents:function(){c.View.prototype.undelegateEvents.apply(this,arguments),d.unbindEvents(this,this.model,this.modelEvents),d.unbindEvents(this,this.collection,this.collectionEvents)},_deleteProp:function(a){var c=this[a];b.each(c,function(a,b){delete c[b]},this),delete this[a]}}),d.ItemView=d.View.extend({constructor:function(){var a;b.isFunction(this.model)&&(this.model=new this.model),b.isFunction(this.collection)&&(this.collection=new this.collection),d.View.prototype.constructor.apply(this,arguments),this.collectionView&&this.collection&&(a=new this.collectionView({collection:this.collection}),this.addSubview("collectionView",a))},render:function(){var a,c;return this.isClosed=!1,a=this.serializeData(),c=d.Utils.render(this.template,a),this.$el.html(c),this._createSubViews(),this._bindRegions(),this._bindUIElements(),b.isFunction(this.afterRender)&&this.afterRender(),this},serializeData:function(){return this.model?this.model.toJSON():this.collection?{items:this.collection.toJSON()}:{}}}),d.CollectionView=d.View.extend({constructor:function(){b.isFunction(this.collection)&&(this.collection=new this.collection),this.children=[],d.View.prototype.constructor.apply(this,arguments),this._initialEvents(),this.initRenderBuffer()},initRenderBuffer:function(){this.elBuffer=document.createDocumentFragment(),this._bufferedChildren=[]},startBuffering:function(){this.initRenderBuffer(),this.isBuffering=!0},endBuffering:function(){this.isBuffering=!1,this.appendBuffer(this,this.elBuffer),this._bufferedChildren=[],this.initRenderBuffer()},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView,this),this.listenTo(this.collection,"remove",this.removeItemView,this),this.listenTo(this.collection,"reset",this.render,this))},addChildView:function(a){var b=this._getItemView(a),c=this.collection.indexOf(a);this.addItemView(a,b,c)},_getItemView:function(){if(!this.itemView)throw"An `itemView` must be specified";return this.itemView},removeItemView:function(a){var c=b.findWhere(this.children,{model:a});this.removeChildView(c)},removeChildView:function(a){a&&(this.stopListening(a),a.close?a.close():a.remove&&a.remove(),this.children=b.without(this.children,a))},render:function(){return this.isClosed=!1,this._renderChildren(),b.isFunction(this.afterRender)&&this.afterRender(),this},addItemView:function(a,b,c){var d=this.buildItemView(a,b,this.itemViewOptions);return this.children.push(d),this.renderItemView(d,c),d},renderItemView:function(a,b){a.render(),this.appendHtml(this,a,b)},buildItemView:function(a,c,d){var e=b.extend({model:a},d);return new c(e)},appendBuffer:function(a,b){a.$el.append(b)},appendHtml:function(a,b){a.isBuffering?(a.elBuffer.appendChild(b.el),a._bufferedChildren.push(b)):a.$el.append(b.el)},isEmpty:function(){return!this.collection||0===this.collection.length},_renderChildren:function(){this.startBuffering(),this.closeChildren(),this.isEmpty()||this.showCollection(),this.endBuffering()},showCollection:function(){this.collection.each(function(a,b){this.addItemView(a,this.itemView,b)},this)},close:function(){this.isClosed||(this.closeChildren(),d.View.prototype.close.apply(this,arguments))},closeChildren:function(){b.each(this.children,function(a){this.removeChildView(a)},this)}}),d.Model=c.Model.extend({constructor:function(a,b){this.configure(b),c.Model.apply(this,arguments),this._mixinComputedProperties()},configure:function(a){b.extend(this.defaults,this.constructor.__super__.defaults),this.options=a||{}},defaults:{ready:!1},isReady:function(){return!0},setReady:function(){this.set("ready",!0)},_mixinComputedProperties:function(){var a=this.attributes||{};return b.extend(a,this.computedProperties)},load:function(){}}),d.Collection=c.Collection.extend({model:d.Model,load:function(){}}),d.Router=c.Router.extend({_bindRoutes:function(){this.routes&&(this.routes=b.result(this,"routes"),b.each(this.routes,function(a){var c,d=b.isArray(a.url)?a.url:[a.url];b.each(d,function(b){c=c||this._createCallback(b,a),this.route(b,a.name,c)},this)},this))},_createCallback:function(a,d){var e,f=this;return e=d.redirectTo?function(){c.history.navigate(d.redirectTo,{trigger:!0,replace:!0})}:function(){var c=[].slice.call(arguments),e=new d.view,g=e.model||e.collection;g&&b.isFunction(g.load)&&(g.urlParams=c,g.load.apply(g,c)),f.trigger("navigate",e,a,c)}}}),d.Application=function(a){b.extend(this,a),this.vent=b.extend({},c.Events)},b.extend(d.Application.prototype,c.Events,{container:"main",el:"page",start:function(a){a.appView&&this._initAppView(a.appView),a.router&&this._initRouter(a.router),this.initialize.apply(this,arguments)},initialize:function(){},_initRouter:function(a){if(this.router=b.isFunction(a)?new a:a,this._initAppRegion(),c.history.start(),!c.history.fragment){var d=b.findWhere(this.router.routes,{"default":!0});d&&this.router.navigate(d.url,{trigger:!0})}},_initAppRegion:function(){var a=this;this.appRegion=new d.Region({el:this.el,initialize:function(){this.listenTo(a.router,"navigate",this.show)},onShow:function(){a.vent.trigger("navigate",this.currentView)}})},_initAppView:function(a){this.appView=b.isFunction(a)?new a:a,$(this.container).empty().append(this.appView.render().el)}}),d.Application.extend=d.extend,function(a,b){if("object"==typeof exports){var c=require("underscore"),d=require("backbone");module.exports=b(c,d)}else"function"==typeof define&&define.amd&&define(["underscore","backbone"],b)}(this,function(){return d})}(this,_,Backbone);
//# sourceMappingURL=backbone.andamio.map